<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/admin-layout :: layout(
        ~{::title},
        ~{::content},
        ~{::css},
        ~{::script}
      )}">

<th:block th:fragment="css">
  <link rel="stylesheet" th:href="@{/css/admin/review.css}">
</th:block>

<th:block th:fragment="script">
</th:block>

<head>
  <title>리뷰 상세</title>
</head>
<body>
<section th:fragment="content" class="admin-content-inner">
  <div class="admin-review-container">
    <h2>리뷰 상세</h2>

    <!-- 성공/에러 메시지 -->
    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-error" th:text="${errorMessage}"></div>

    <div th:if="${review}" class="review-detail">
      <div class="detail-section">
        <h3>기본 정보</h3>
        <table class="detail-table">
          <tr>
            <th>리뷰 ID</th>
            <td th:text="${review.reviewId}">1</td>
          </tr>
          <tr>
            <th>강의명</th>
            <td>
              <span th:text="${review.courseTitle}">강의명</span>
              <span th:if="${review.courseId != null}">
                <a th:href="@{'/CourseDetail?courseId=' + ${review.courseId}}" 
                   target="_blank" 
                   class="course-detail-link">
                  [강의 상세보기]
                </a>
              </span>
            </td>
          </tr>
          <tr>
            <th>사용자</th>
            <td th:text="${review.userName + ' (' + review.userEmail + ')'}">사용자명 (email@example.com)</td>
          </tr>
          <tr>
            <th>평점</th>
            <td>
              <span class="rating" th:text="'★ ' + ${review.rating}">★ 5</span>
            </td>
          </tr>
          <tr>
            <th>상태</th>
            <td>
              <span class="status-badge" 
                    th:classappend="${review.commentStatus == 'Active'} ? 'status-pending' : 
                                   (${review.commentStatus == 'Approved'} ? 'status-approved' : 'status-rejected')"
                    th:text="${review.commentStatus == 'Active'} ? '대기' : 
                            (${review.commentStatus == 'Approved'} ? '승인' : '거부')">대기</span>
            </td>
          </tr>
          <tr>
            <th>작성일</th>
            <td th:text="${#temporals.format(review.createdAt, 'yyyy-MM-dd HH:mm:ss')}">2024-01-01 12:00:00</td>
          </tr>
          <tr>
            <th>수정일</th>
            <td th:text="${#temporals.format(review.updatedAt, 'yyyy-MM-dd HH:mm:ss')}">2024-01-01 12:00:00</td>
          </tr>
        </table>
      </div>

      <div class="detail-section">
        <h3>리뷰 내용</h3>
        <div class="review-content">
          <p th:text="${review.comment}">리뷰 내용...</p>
        </div>
      </div>

      <!-- 리뷰 상세/검수 화면 (PASS/APPROVE/REJECT 처리) -->
      <div class="detail-actions">
        <form th:action="@{'/admin/review/' + ${review.reviewId} + '/approve'}" method="post" class="detail-action-form">
          <button type="submit" class="btn-approve">승인(APPROVE)</button>
        </form>
        <form th:action="@{'/admin/review/' + ${review.reviewId} + '/reject'}" method="post" class="detail-action-form">
          <button type="submit" class="btn-reject">거부(REJECT)</button>
        </form>
        <form th:action="@{'/admin/review/' + ${review.reviewId} + '/update-status'}" method="post" class="detail-action-form">
          <input type="hidden" name="status" value="Active">
          <button type="submit" class="btn-pass">대기(PASS)</button>
        </form>
        <form th:action="@{'/admin/review/' + ${review.reviewId} + '/delete'}" method="post" class="detail-action-form"
              onsubmit="return confirm('정말 삭제하시겠습니까?');">
          <button type="submit" class="btn-delete">삭제</button>
        </form>
      </div>

      <div class="back-link">
        <a href="/admin/review" class="btn-back">목록으로</a>
      </div>
    </div>
  </div>
</section>
</body>
</html>

