<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:fragment="layout(title, content, css, script)">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" th:href="@{/images/logo_icon.png}" type="image/png">
    <title th:replace="${title}">마이페이지 | LearnI</title>

    <link rel="stylesheet" th:href="@{/css/common/base.css}">
    <link rel="stylesheet" th:href="@{/css/common/header.css}">
    <link rel="stylesheet" th:href="@{/css/common/footer.css}">
    <link rel="stylesheet" th:href="@{/css/common/mainnav.css}">
    <link rel="stylesheet" th:href="@{/css/home/chatbot.css}">
    <link rel="stylesheet" th:href="@{/css/mypage/mypage.css}">
    <link rel="stylesheet" th:href="@{/css/mypage/mypageNavbar.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!--페이지별 css-->
    <th:block th:replace="${css}"></th:block>
</head>

<body>

<div th:replace="fragments/header :: site-header"></div>

<!-- 마이페이지 모바일 네비게이션 바 -->
<div th:replace="fragments/mypageNavbar :: mypage-mobile-navbar"></div>

<div class="layout-container">
    <!-- 데스크탑 사이드바 -->
    <div th:replace="fragments/mypageNavbar :: mypage-sidebar"></div>
    
    <main class="layout-content">
        <div th:replace="${content}"></div>
    </main>
</div>

<!-- 챗봇(모든 페이지 공통 요소) -->
<div th:replace="fragments/chatbot :: chatbot"></div>

<div th:replace="fragments/footer :: footer"></div>

<!--챗봇 공통 js-->
<script th:src="@{/js/home/chatbot.js}"></script>

<!-- 마이페이지 네비게이션 active 클래스 처리 -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const currentPath = window.location.pathname;
        
        // 모바일 네비게이션 활성화
        const mobileNavLinks = document.querySelectorAll('.mypage-mobile-nav .nav-link');
        mobileNavLinks.forEach(link => {
            const linkPath = link.getAttribute('data-path');
            // /mypage/dashboard 또는 /mypage로 접근 시 대시보드 활성화
            if (linkPath === '/mypage' && (currentPath === '/mypage' || currentPath === '/mypage/' || currentPath === '/mypage/dashboard')) {
                link.classList.add('active');
            } else if (linkPath !== '/mypage' && currentPath.startsWith(linkPath)) {
                link.classList.add('active');
            }
        });
        
        // 데스크탑 사이드바 네비게이션 활성화
        const desktopNavLinks = document.querySelectorAll('.mypage-nav .nav-link');
        desktopNavLinks.forEach(link => {
            const linkPath = link.getAttribute('data-path');
            // /mypage/dashboard 또는 /mypage로 접근 시 대시보드 활성화
            if (linkPath === '/mypage' && (currentPath === '/mypage' || currentPath === '/mypage/' || currentPath === '/mypage/dashboard')) {
                link.classList.add('active');
            } else if (linkPath !== '/mypage' && currentPath.startsWith(linkPath)) {
                link.classList.add('active');
            }
        });
    });
</script>

<th:block th:replace="${script}"></th:block>

</body>
</html>
