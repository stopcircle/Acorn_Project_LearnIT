<th:block xmlns:th="http://www.thymeleaf.org" th:fragment="introFragment(course)">

    <h2 class="cd-h2">강의 소개</h2>

    <!-- ✅ 강의 상세 이미지 또는 PDF/텍스트 -->
    <div class="cd-detail-img-wrap" th:if="${course.detailImgUrl != null}">

        <!-- 1. 텍스트 파일(.txt)인 경우 (PDF에서 추출된 텍스트) -->
        <th:block th:if="${#strings.endsWith(#strings.toLowerCase(course.detailImgUrl), '.txt')}">
            <div id="course-detail-text" class="course-detail-text">
                강의 소개 내용을 불러오는 중입니다...
            </div>
            <script th:inline="javascript">
                (function() {
                    var txtUrl = [[${course.detailImgUrl}]];
                    fetch(txtUrl)
                        .then(function(response) { return response.text(); })
                        .then(function(text) {
                            document.getElementById('course-detail-text').innerText = text;
                        })
                        .catch(function(err) {
                            console.error(err);
                            document.getElementById('course-detail-text').innerText = "내용을 불러오는 데 실패했습니다.";
                        });
                })();
            </script>
        </th:block>

        <!-- 2. PDF인 경우 (백업/기존 데이터용) -->
        <th:block th:if="${#strings.endsWith(#strings.toLowerCase(course.detailImgUrl), '.pdf')}">
            <div class="cd-pdf-wrap">
                <iframe
                        class="cd-detail-iframe"
                        th:src="${course.detailImgUrl}"
                        title="강의 소개 PDF">
                    이 브라우저는 PDF 미리보기를 지원하지 않습니다.
                    <a th:href="${course.detailImgUrl}">여기</a>를 클릭하여 다운로드하세요.
                </iframe>
            </div>
        </th:block>

        <!-- 3. 이미지인 경우 -->
        <th:block th:if="${!#strings.endsWith(#strings.toLowerCase(course.detailImgUrl), '.pdf') and !#strings.endsWith(#strings.toLowerCase(course.detailImgUrl), '.txt')}">
            <img class="cd-detail-img" th:src="${course.detailImgUrl}" alt="강의 상세 이미지">
        </th:block>
    </div>

</th:block>
